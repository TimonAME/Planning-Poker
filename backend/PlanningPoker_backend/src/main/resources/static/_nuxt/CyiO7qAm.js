import{b as v,u as S,a as x,r as H,m as w,d as T,_ as C}from"./C3dXl6jG.js";import{a1 as L,o as $,r as M,v as c,M as b,z as N,x as e,Q as U,$ as j,O as i,a2 as O,P as A,S as y,T as D,t as u,y as V,ad as k,ac as B}from"./CvagovfX.js";import{a as P}from"./DcrxrpLV.js";import"https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js";const R={id:"my_modal_7",class:"modal"},z={class:"modal-box"},q=e("h3",{class:"font-bold text-lg mb-1"},"Username",-1),E={class:"form-control w-full"},F={class:"error-msg text-sm ml-1 mt-1 text-red-600"},J=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary mt-2"}," Submit ")],-1),X={__name:"username-input",setup(Q){const m=L();$(()=>{my_modal_7.showModal()});const a=M(""),_={username:{required:H,minLength:w(1),maxLength:T(20)}},n=v(_,{username:a}),f=S(),o=x();function h(){let t="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=s.length;let r=0;for(;r<32;)t+=s.charAt(Math.floor(Math.random()*l)),r+=1;return t}const d=h(),p=h(),g=()=>{if(n.value.$touch(),!n.value.$error)if(o.setUserDetails(a.value,d,p),o.name===""){const s=k().params;console.log(s),fetch("http://localhost:8080/lobby",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:{userHash:d,publicUserHash:p,userName:a.value,lobbyHash:s}}).then(l=>l.json()).then(l=>{console.log(l),console.log("joined"),m.push("/prelobby/"+s)})}else console.log("hallllo"),fetch("http://localhost:8080/create",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({lobbyHash:o.lobbyHash,userHash:o.userHash,lobbyDescription:o.description,lobbyName:o.name,lobbyCardType:o.votingSystemName})}).then(t=>t.json()).then(t=>{console.log(t),console.log("createLobby called"),P().activateStompClient(o.lobbyHash),m.push("/prelobby"),f.addUser(a.value,"not ready",!0),my_modal_7.close()})};return(t,s)=>{const l=C;return u(),c(y,null,[b(N(l,null,null,512),[[B,!1]]),e("dialog",R,[e("div",z,[q,e("form",{onSubmit:U(g,["prevent"])},[e("label",E,[e("div",{class:j({error:i(n).username.$errors.length})},[b(e("input",{type:"text",placeholder:"Type here",class:"input input-bordered w-full","onUpdate:modelValue":s[0]||(s[0]=r=>A(a)?a.value=r:null)},null,512),[[O,i(a)]]),(u(!0),c(y,null,D(i(n).username.$errors,r=>(u(),c("div",{class:"input-errors",key:r.$uid},[e("div",F,V(r.$message),1)]))),128))],2)]),J],32)])])],64)}}};export{X as default};
