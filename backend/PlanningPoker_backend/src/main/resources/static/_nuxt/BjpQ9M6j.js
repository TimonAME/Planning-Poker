import{a as v,u as S,r as x,m as H,c as w,_ as T}from"./BLBwX6xI.js";import{a1 as C,o as L,r as $,v as c,M as b,z as M,x as e,Q as N,$ as U,O as i,a2 as j,P as O,S as y,T as A,t as u,y as D,a3 as V,ad as k}from"./BuXVwhvL.js";import{u as B}from"./DF2uFKYm.js";import{a as P}from"./eGHs9HnP.js";import"https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js";const R={id:"my_modal_7",class:"modal"},z={class:"modal-box"},q=e("h3",{class:"font-bold text-lg mb-1"},"Username",-1),E={class:"form-control w-full"},F={class:"error-msg text-sm ml-1 mt-1 text-red-600"},J=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary mt-2"}," Submit ")],-1),Y={__name:"username-input",setup(Q){const m=C();L(()=>{my_modal_7.showModal()});const a=$(""),_={username:{required:x,minLength:H(1),maxLength:w(20)}},n=v(_,{username:a}),f=S(),o=B();function h(){let t="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=s.length;let l=0;for(;l<32;)t+=s.charAt(Math.floor(Math.random()*r)),l+=1;return t}const d=h(),p=h(),g=()=>{if(n.value.$touch(),!n.value.$error)if(o.setUserDetails(a.value,d,p),o.name===""){const s=V().params;console.log(s),fetch("http://localhost:8080/lobby",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:{userHash:d,publicUserHash:p,userName:a.value,lobbyHash:s}}).then(r=>r.json()).then(r=>{console.log(r),console.log("joined"),m.push("/prelobby/"+s)})}else console.log("hallllo"),fetch("http://localhost:8080/create",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({lobbyHash:o.lobbyHash,userHash:o.userHash,lobbyDescription:o.description,lobbyName:o.name,lobbyCardType:o.votingSystemName})}).then(t=>t.json()).then(t=>{console.log(t),console.log("createLobby called"),P().activateStompClient(o.lobbyHash),m.push("/prelobby"),f.addUser(a.value,"not ready",!0),my_modal_7.close()})};return(t,s)=>{const r=T;return u(),c(y,null,[b(M(r,null,null,512),[[k,!1]]),e("dialog",R,[e("div",z,[q,e("form",{onSubmit:N(g,["prevent"])},[e("label",E,[e("div",{class:U({error:i(n).username.$errors.length})},[b(e("input",{type:"text",placeholder:"Type here",class:"input input-bordered w-full","onUpdate:modelValue":s[0]||(s[0]=l=>O(a)?a.value=l:null)},null,512),[[j,i(a)]]),(u(!0),c(y,null,A(i(n).username.$errors,l=>(u(),c("div",{class:"input-errors",key:l.$uid},[e("div",F,D(l.$message),1)]))),128))],2)]),J],32)])])],64)}}};export{Y as default};
