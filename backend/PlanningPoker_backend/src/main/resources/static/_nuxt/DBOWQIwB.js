import{b as v,u as S,a as x,r as H,m as w,d as T,_ as C}from"./B2qw3buu.js";import{a1 as L,o as $,r as M,v as c,M as p,z as N,x as e,Q as U,$ as O,O as i,a2 as A,P as D,S as b,T as j,t as u,y as V,ac as k}from"./0UAU7Jqz.js";import{a as B}from"./DVSSvIU1.js";import"https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js";const P={id:"my_modal_7",class:"modal"},z={class:"modal-box"},R=e("h3",{class:"font-bold text-lg mb-1"},"Username",-1),q={class:"form-control w-full"},E={class:"error-msg text-sm ml-1 mt-1 text-red-600"},F=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"btn btn-primary mt-2"}," Submit ")],-1),W={__name:"username-input",setup(J){const y=L();$(()=>{my_modal_7.showModal()});const t=M(""),_={username:{required:H,minLength:w(1),maxLength:T(20)}},l=v(_,{username:t}),f=S(),s=x();function m(){let o="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length;let a=0;for(;a<32;)o+=r.charAt(Math.floor(Math.random()*n)),a+=1;return o}const d=m(),h=m(),g=()=>{l.value.$touch(),l.value.$error||(s.setUserDetails(t.value,d,h),s.name===""?fetch("http://localhost:8080/lobby",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:{userHash:d,publicUserHash:h,userName:t.value,lobbyHash:""}}):(console.log("hallllo"),fetch("http://localhost:8080/create",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({lobbyHash:s.lobbyHash,userHash:s.userHash,lobbyDescription:s.description,lobbyName:s.name,lobbyCardType:s.votingSystemName})}).then(o=>o.json()).then(o=>{console.log(o),console.log("createLobby called"),B().activateStompClient(s.lobbyHash),y.push("/prelobby"),f.addUser(t.value,"not ready",!0),my_modal_7.close()})))};return(o,r)=>{const n=C;return u(),c(b,null,[p(N(n,null,null,512),[[k,!1]]),e("dialog",P,[e("div",z,[R,e("form",{onSubmit:U(g,["prevent"])},[e("label",q,[e("div",{class:O({error:i(l).username.$errors.length})},[p(e("input",{type:"text",placeholder:"Type here",class:"input input-bordered w-full","onUpdate:modelValue":r[0]||(r[0]=a=>D(t)?t.value=a:null)},null,512),[[A,i(t)]]),(u(!0),c(b,null,j(i(l).username.$errors,a=>(u(),c("div",{class:"input-errors",key:a.$uid},[e("div",E,V(a.$message),1)]))),128))],2)]),F],32)])])],64)}}};export{W as default};
